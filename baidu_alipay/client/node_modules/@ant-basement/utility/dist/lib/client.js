"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const op_1 = tslib_1.__importDefault(require("./model/op"));
const utility_1 = require("./utility");
const specs_1 = require("./model/specs");
class Query {
    constructor(collection) {
        return new Proxy(this, {
            get(target, prop, receiver) {
                if (specs_1.isCollectionOp(prop)) {
                    return function bound(...raw) {
                        const op = prop.toString();
                        const spec = specs_1.OP_SPECS[op];
                        const args = spec.keys.reduce((accu, key, i) => {
                            accu[key] = raw[i];
                            return accu;
                        }, {});
                        args.collection = collection;
                        return new op_1.default(op, args);
                    };
                }
                return Reflect.get(target, prop, receiver);
            },
        });
    }
}
class Client {
    collection(name) {
        utility_1.validator.validate({ name: 'collectionName' }, { name });
        return new Query(name);
    }
    collections() {
        return new op_1.default('collections');
    }
    createCollection(name, options = {}) {
        return new op_1.default('createCollection', { name, options });
    }
}
exports.default = Client;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL2NsaWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw0REFBNEI7QUFDNUIsdUNBQXNDO0FBQ3RDLHlDQUF5RDtBQUV6RDtJQUNFLFlBQVksVUFBVTtRQUNwQixPQUFPLElBQUksS0FBSyxDQUFDLElBQUksRUFBRTtZQUNyQixHQUFHLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxRQUFRO2dCQUN4QixJQUFJLHNCQUFjLENBQUMsSUFBSSxDQUFDLEVBQUU7b0JBQ3hCLE9BQU8sZUFBZSxHQUFHLEdBQUc7d0JBQzFCLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQzt3QkFDM0IsTUFBTSxJQUFJLEdBQUcsZ0JBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQzt3QkFDMUIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFOzRCQUM3QyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUNuQixPQUFPLElBQUksQ0FBQzt3QkFDZCxDQUFDLEVBQUUsRUFBRSxDQUFRLENBQUM7d0JBRWQsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7d0JBQzdCLE9BQU8sSUFBSSxZQUFFLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUMxQixDQUFDLENBQUM7aUJBQ0g7Z0JBRUQsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDN0MsQ0FBQztTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQUVEO0lBQ1MsVUFBVSxDQUFDLElBQVk7UUFDNUIsbUJBQVMsQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFDekQsT0FBTyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQVEsQ0FBQztJQUNoQyxDQUFDO0lBRU0sV0FBVztRQUNoQixPQUFPLElBQUksWUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFTSxnQkFBZ0IsQ0FBQyxJQUFZLEVBQUUsVUFBZSxFQUFFO1FBQ3JELE9BQU8sSUFBSSxZQUFFLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUN2RCxDQUFDO0NBQ0Y7QUFFRCxrQkFBZSxNQUFNLENBQUMifQ==